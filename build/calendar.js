(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var a in n)e.o(n,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:n[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.domReady;var n=e.n(t);const a=window.wp.element,s=window.wp.i18n,o=window.ReactJSXRuntime,i=({appointment:e})=>{const t=e=>{switch(e){case"pending":return"#f0ad4e";case"confirmed":return"#5cb85c";case"completed":return"#337ab7";case"cancelled":return"#d9534f";default:return"#777"}},n=e=>{switch(e){case"pending":return(0,s.__)("Pending","appointment-booking");case"confirmed":return(0,s.__)("Confirmed","appointment-booking");case"completed":return(0,s.__)("Completed","appointment-booking");case"cancelled":return(0,s.__)("Cancelled","appointment-booking");default:return e}};return(0,o.jsx)("div",{className:"time-block",style:{backgroundColor:t(e.status),borderLeftColor:t(e.status)},title:`${e.client_name} - ${e.client_phone} - ${n(e.status)}`,children:(0,o.jsxs)("div",{className:"time-block-content",children:[(0,o.jsx)("div",{className:"client-name",children:e.client_name}),(0,o.jsx)("div",{className:"time-slot",children:(a=e.time_slot,a.replace("-"," - "))}),(0,o.jsx)("div",{className:"status-badge",children:n(e.status)})]})});var a},r=({date:e,appointments:t,isToday:n})=>(0,o.jsxs)("div",{className:"day-column "+(n?"today":""),children:[(0,o.jsxs)("div",{className:"day-header",children:[(0,o.jsx)("div",{className:"day-name",children:(e=>e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}))(e)}),(0,o.jsxs)("div",{className:"appointment-count",children:[t.length," ",(0,s.__)("appointments","appointment-booking")]})]}),(0,o.jsx)("div",{className:"time-slots",children:["9:00-10:00","10:00-11:00","11:00-12:00","14:00-15:00","15:00-16:00","16:00-17:00"].map((n,a)=>{const r=(e=>t.find(t=>t.time_slot===e))(n),c=(t=>{const n=new Date,{start:a,end:s}=(t=>{const[n,a]=t.split("-"),[s,o]=n.split(":").map(e=>parseInt(e,10)),[i,r]=a.split(":").map(e=>parseInt(e,10)),c=new Date(e);c.setHours(s,o||0,0,0);const l=new Date(e);return l.setHours(i,r||0,0,0),{start:c,end:l}})(t);return s<n?"past-full":a<n?"past-partial":""})(n);return(0,o.jsx)("div",{className:`time-slot-container ${c}`,children:(0,o.jsx)("div",{className:"time-slot-content",children:r?(0,o.jsx)(i,{appointment:r}):(0,o.jsx)("div",{className:"empty-slot",children:(0,s.__)("Available","appointment-booking")})})},a)})})]}),c=()=>(0,o.jsxs)("div",{className:"time-column",children:[(0,o.jsx)("div",{className:"time-header",children:"Time"}),["9:00-10:00","10:00-11:00","11:00-12:00","14:00-15:00","15:00-16:00","16:00-17:00"].map((e,t)=>(0,o.jsx)("div",{className:"time-slot",children:e},t))]}),l=()=>{const[e,t]=(0,a.useState)([]),[n,i]=(0,a.useState)(!0),[l,d]=(0,a.useState)(null),[m,p]=(0,a.useState)(new Date);console.log("CalendarView"),(0,a.useEffect)(()=>{u()},[m]);const u=async()=>{try{i(!0),d(null);const e=await fetch("/wp-json/appointment-booking/v1/appointments",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(!e.ok)throw new Error("Failed to fetch appointments");const n=await e.json();console.log(n),t(n)}catch(e){d(e.message),console.error("Error fetching appointments:",e)}finally{i(!1)}},h=t=>{const n=t.toISOString().split("T")[0];return e.filter(e=>e.appointment_date===n)},g=e=>{const t=new Date(m);t.setDate(m.getDate()+7*e),p(t)};if(n)return(0,o.jsx)("div",{className:"calendar-loading",children:(0,o.jsx)("p",{children:(0,s.__)("Loading calendar...","appointment-booking")})});if(l)return(0,o.jsxs)("div",{className:"calendar-error",children:[(0,o.jsxs)("p",{children:[(0,s.__)("Error loading calendar:","appointment-booking")," ",l]}),(0,o.jsx)("button",{onClick:u,children:(0,s.__)("Retry","appointment-booking")})]});const j=(e=>{const t=new Date(e),n=t.getDay(),a=t.getDate()-n+(0===n?-6:1);t.setDate(a);const s=[];for(let e=0;e<7;e++){const n=new Date(t);n.setDate(t.getDate()+e),s.push(n)}return s})(m),x=new Date,_=j.some(e=>e.toDateString()===x.toDateString());return(0,o.jsxs)("div",{className:"calendar-view",children:[(0,o.jsxs)("div",{className:"calendar-header",children:[(0,o.jsx)("h2",{children:(0,s.__)("Appointment Calendar","appointment-booking")}),(0,o.jsxs)("div",{className:"calendar-navigation",children:[(0,o.jsx)("button",{onClick:()=>g(-1),children:(0,s.__)("Previous Week","appointment-booking")}),(0,o.jsx)("button",{onClick:()=>{p(new Date)},className:_?"current-week":"",children:(0,s.__)("Today","appointment-booking")}),(0,o.jsx)("button",{onClick:()=>g(1),children:(0,s.__)("Next Week","appointment-booking")})]})]}),(0,o.jsxs)("div",{className:"calendar-grid",children:[(0,o.jsx)(c,{}),j.map((e,t)=>(0,o.jsx)(r,{date:e,appointments:h(e),isToday:e.toDateString()===x.toDateString()},t))]})]})};n()(()=>{console.log("Calendar"),(0,a.createRoot)(document.getElementById("appointment-booking-calendar")).render((0,o.jsx)(l,{}))})})();