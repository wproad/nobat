(()=>{"use strict";var e={n:n=>{var t=n&&n.__esModule?()=>n.default:()=>n;return e.d(t,{a:t}),t},d:(n,t)=>{for(var a in t)e.o(t,a)&&!e.o(n,a)&&Object.defineProperty(n,a,{enumerable:!0,get:t[a]})},o:(e,n)=>Object.prototype.hasOwnProperty.call(e,n)};const n=window.wp.domReady;var t=e.n(n);const a=window.wp.element,o=window.wp.i18n,s=window.ReactJSXRuntime,i=({appointment:e})=>{const n=e=>{switch(e){case"pending":return"#f0ad4e";case"confirmed":return"#5cb85c";case"completed":return"#337ab7";case"cancelled":return"#d9534f";default:return"#777"}},t=e=>{switch(e){case"pending":return(0,o.__)("Pending","appointment-booking");case"confirmed":return(0,o.__)("Confirmed","appointment-booking");case"completed":return(0,o.__)("Completed","appointment-booking");case"cancelled":return(0,o.__)("Cancelled","appointment-booking");default:return e}};return(0,s.jsx)("div",{className:"time-block",style:{backgroundColor:n(e.status),borderLeftColor:n(e.status)},title:`${e.client_name} - ${e.client_phone} - ${t(e.status)}`,children:(0,s.jsxs)("div",{className:"time-block-content",children:[(0,s.jsx)("div",{className:"client-name",children:e.client_name}),(0,s.jsx)("div",{className:"time-slot",children:(a=e.time_slot,a.replace("-"," - "))}),(0,s.jsx)("div",{className:"status-badge",children:t(e.status)})]})});var a},r=({date:e,appointments:n,isToday:t})=>(0,s.jsxs)("div",{className:"day-column "+(t?"today":""),children:[(0,s.jsxs)("div",{className:"day-header",children:[(0,s.jsx)("div",{className:"day-name",children:(e=>e.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}))(e)}),(0,s.jsxs)("div",{className:"appointment-count",children:[n.length," ",(0,o.__)("appointments","appointment-booking")]})]}),(0,s.jsx)("div",{className:"time-slots",children:["9:00-10:00","10:00-11:00","11:00-12:00","14:00-15:00","15:00-16:00","16:00-17:00"].map((e,t)=>{const a=(e=>n.find(n=>n.time_slot===e))(e);return(0,s.jsxs)("div",{className:"time-slot-container",children:[(0,s.jsx)("div",{className:"time-slot-label",children:e}),(0,s.jsx)("div",{className:"time-slot-content",children:a?(0,s.jsx)(i,{appointment:a}):(0,s.jsx)("div",{className:"empty-slot",children:(0,o.__)("Available","appointment-booking")})})]},t)})})]}),c=()=>{const[e,n]=(0,a.useState)([]),[t,i]=(0,a.useState)(!0),[c,l]=(0,a.useState)(null),[d,m]=(0,a.useState)(new Date);console.log("CalendarView"),(0,a.useEffect)(()=>{p()},[d]);const p=async()=>{try{i(!0),l(null);const e=await fetch("/wp-json/appointment-booking/v1/appointments",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":wpApiSettings.nonce}});if(!e.ok)throw new Error("Failed to fetch appointments");const t=await e.json();console.log(t),n(t)}catch(e){l(e.message),console.error("Error fetching appointments:",e)}finally{i(!1)}},u=n=>{const t=n.toISOString().split("T")[0];return e.filter(e=>e.appointment_date===t)},h=e=>{const n=new Date(d);n.setDate(d.getDate()+7*e),m(n)};if(t)return(0,s.jsx)("div",{className:"calendar-loading",children:(0,s.jsx)("p",{children:(0,o.__)("Loading calendar...","appointment-booking")})});if(c)return(0,s.jsxs)("div",{className:"calendar-error",children:[(0,s.jsxs)("p",{children:[(0,o.__)("Error loading calendar:","appointment-booking")," ",c]}),(0,s.jsx)("button",{onClick:p,children:(0,o.__)("Retry","appointment-booking")})]});const g=(e=>{const n=new Date(e),t=n.getDay(),a=n.getDate()-t+(0===t?-6:1);n.setDate(a);const o=[];for(let e=0;e<7;e++){const t=new Date(n);t.setDate(n.getDate()+e),o.push(t)}return o})(d),j=new Date,_=g.some(e=>e.toDateString()===j.toDateString());return(0,s.jsxs)("div",{className:"calendar-view",children:[(0,s.jsxs)("div",{className:"calendar-header",children:[(0,s.jsx)("h2",{children:(0,o.__)("Appointment Calendar","appointment-booking")}),(0,s.jsxs)("div",{className:"calendar-navigation",children:[(0,s.jsx)("button",{onClick:()=>h(-1),children:(0,o.__)("Previous Week","appointment-booking")}),(0,s.jsx)("button",{onClick:()=>{m(new Date)},className:_?"current-week":"",children:(0,o.__)("Today","appointment-booking")}),(0,s.jsx)("button",{onClick:()=>h(1),children:(0,o.__)("Next Week","appointment-booking")})]})]}),(0,s.jsx)("div",{className:"calendar-grid",children:g.map((e,n)=>(0,s.jsx)(r,{date:e,appointments:u(e),isToday:e.toDateString()===j.toDateString()},n))})]})};t()(()=>{console.log("Calendar"),(0,a.createRoot)(document.getElementById("appointment-booking-calendar")).render((0,s.jsx)(c,{}))})})();